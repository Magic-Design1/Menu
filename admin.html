<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite Admin - Kitchen Display</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #2563eb; --danger: #ef4444; --success: #10b981; --bg: #f1f5f9; --text: #0f172a; }
        * { box-sizing: border-box; }
        
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background: var(--bg); 
            margin: 0; 
            color: var(--text);
            padding: 15px;
        }

        /* Header UI */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 10px 5px;
        }
        header h1 { font-size: 1.4rem; margin: 0; font-weight: 800; }
        
        .status-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #fff;
            padding: 6px 12px;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 700;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .dot { width: 8px; height: 8px; background: var(--success); border-radius: 50%; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; } }

        /* Responsive Grid */
        .admin-grid {
            display: grid;
            grid-template-columns: 1fr; /* ÿπŸÖŸàÿØ Ÿàÿßÿ≠ÿØ ŸÑŸÑŸÖŸàÿ®ÿßŸäŸÑ */
            gap: 20px;
        }

        @media (min-width: 992px) {
            .admin-grid { grid-template-columns: 350px 1fr; } /* ÿ™ŸÇÿ≥ŸäŸÖ ÿßŸÑÿ¥ÿßÿ¥ÿ© ŸÑŸÑŸÉŸÖÿ®ŸäŸàÿ™ÿ± */
        }

        .panel {
            background: transparent;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .panel-title {
            font-size: 1rem;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 5px;
        }

        /* Waiter Alert Card */
        .waiter-card {
            background: #fee2e2;
            border: 2px solid #fecaca;
            color: #b91c1c;
            padding: 15px;
            border-radius: 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.1);
            animation: bounceIn 0.5s ease;
        }
        @keyframes bounceIn {
            0% { transform: scale(0.9); opacity: 0; }
            70% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Order Card UI */
        .order-card {
            background: #ffffff;
            border-radius: 22px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.03);
            border: 1px solid #e2e8f0;
            margin-bottom: 15px;
            position: relative;
            overflow: hidden;
        }
        .order-card::before {
            content: '';
            position: absolute;
            left: 0; top: 0; bottom: 0;
            width: 6px;
            background: var(--primary);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        .table-no { font-size: 1.2rem; font-weight: 800; color: var(--primary); }
        .order-time { font-size: 0.75rem; color: #94a3b8; font-weight: 600; }

        .items-list {
            list-style: none;
            padding: 0;
            margin: 0 0 15px 0;
        }
        .items-list li {
            padding: 8px 0;
            border-bottom: 1px dashed #f1f5f9;
            display: flex;
            justify-content: space-between;
            font-size: 0.95rem;
        }
        .items-list li:last-child { border-bottom: none; }
        .qty { font-weight: 800; color: var(--text); margin-right: 10px; }

        .order-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #f1f5f9;
        }
        .total-price { font-weight: 800; font-size: 1.1rem; color: var(--text); }
        .status-tag {
            font-size: 0.7rem;
            font-weight: 800;
            padding: 4px 10px;
            border-radius: 8px;
            background: #e0e7ff;
            color: #4338ca;
            text-transform: uppercase;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px;
            opacity: 0.5;
            font-weight: 600;
        }
    </style>
</head>
<body>

<header>
    <h1>Elite Console</h1>
    <div class="status-badge">
        <div class="dot"></div>
        <span id="sync-text">LIVE SYNC</span>
    </div>
</header>

<div class="admin-grid">
    <div class="panel">
        <div class="panel-title">üõéÔ∏è Waiter Calls</div>
        <div id="waiter-list">
            </div>
    </div>

    <div class="panel">
        <div class="panel-title">üìã Active Orders</div>
        <div id="order-list">
            <div class="empty-state">Waiting for new orders...</div>
        </div>
    </div>
</div>

<script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwsS6zErft-eK55CndjMFwTO-kHsMX-WxeXvQHgwJ1W_eHotYOMmn715lKuw2IKsbPwBA/exec";
    
    // ŸÑÿ™ÿ¨ŸÜÿ® ÿ™ŸÉÿ±ÿßÿ± ÿßŸÑÿ™ŸÜÿ®ŸäŸáÿßÿ™ ÿßŸÑÿµŸàÿ™Ÿäÿ©
    let lastKnownCount = 0;
    const alertSound = new Audio('https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3');

    async function updateDashboard() {
        try {
            const response = await fetch(SCRIPT_URL);
            const data = await response.json();
            
            const orders = data.filter(d => d.items);
            const waiterCalls = data.filter(d => d.type === 'waiter');

            // ÿ™ÿ¥ÿ∫ŸäŸÑ ÿµŸàÿ™ ÿπŸÜÿØ Ÿàÿ¨ŸàÿØ ÿ∑ŸÑÿ® ÿ¨ÿØŸäÿØ
            if (data.length > lastKnownCount && lastKnownCount !== 0) {
                alertSound.play().catch(e => console.log("Sound blocked"));
            }
            lastKnownCount = data.length;

            renderWaiterCalls(waiterCalls);
            renderOrders(orders);

            document.getElementById('sync-text').innerText = "LIVE SYNC";
        } catch (error) {
            document.getElementById('sync-text').innerText = "OFFLINE";
        }
    }

    function renderWaiterCalls(calls) {
        const container = document.getElementById('waiter-list');
        if (calls.length === 0) {
            container.innerHTML = '<div style="font-size:0.8rem; opacity:0.6; padding:10px;">No active calls.</div>';
            return;
        }

        container.innerHTML = calls.reverse().map(c => `
            <div class="waiter-card">
                <div>
                    <div style="font-size:0.7rem; opacity:0.8; font-weight:700;">ASSISTANCE NEEDED</div>
                    <div style="font-size:1.1rem;">Table ${c.table}</div>
                </div>
                <button onclick="this.parentElement.style.display='none'" style="background:none; border:none; cursor:pointer; font-size:1.2rem;">‚úï</button>
            </div>
        `).join('');
    }

    function renderOrders(orders) {
        const container = document.getElementById('order-list');
        if (orders.length === 0) {
            container.innerHTML = '<div class="empty-state">No active orders in the kitchen.</div>';
            return;
        }

        container.innerHTML = orders.reverse().map(o => `
            <div class="order-card">
                <div class="order-header">
                    <span class="table-no">TABLE ${o.table}</span>
                    <span class="order-time">${new Date(o.time).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>
                </div>
                
                <ul class="items-list">
                    ${o.items.map(item => `
                        <li>
                            <span><span class="qty">${item.qty}x</span> ${item.name}</span>
                            <span style="font-size:0.8rem; color:#64748b;">$${(item.price * item.qty).toFixed(2)}</span>
                        </li>
                    `).join('')}
                </ul>

                <div class="order-footer">
                    <span class="status-tag">${o.status || 'Pending'}</span>
                    <span class="total-price">${o.total}</span>
                </div>
            </div>
        `).join('');
    }

    // ÿ™ÿ≠ÿØŸäÿ´ ŸÉŸÑ 5 ÿ´ŸàÿßŸÜŸç
    setInterval(updateDashboard, 5000);
    updateDashboard(); // ÿ™ÿ¥ÿ∫ŸäŸÑ ŸÅŸàÿ±Ÿä ÿπŸÜÿØ ÿßŸÑŸÅÿ™ÿ≠
</script>
</body>
</html>
